<div class="spinner">
  <mat-progress-spinner *ngIf="isLoading && (!hasFetchedInstances || !hasFetchedCharacters || !hasFetchedPurposes || !hasFetchedJobs)" class="spinner" color="primary" mode="indeterminate" diameter="40" strokeWidth="7"></mat-progress-spinner>
  <div class="progress-notifications">
    <span *ngIf="!hasFetchedInstances && timeLeft > 0">Fetching Instance Data...</span>
    <span *ngIf="!hasFetchedCharacters && timeLeft > 0">Fetching Character Data...</span>
    <span *ngIf="!hasFetchedJobs && timeLeft > 0">Fetching Job Data...</span>
    <span *ngIf="!hasFetchedPurposes && timeLeft > 0">Fetching Party Purpose Data...</span>
    <span *ngIf="!hasFetchedParties && timeLeft > 0">Fetching Parties...</span>
    <span *ngIf="isLoading && timeLeft == 0">Failed to Retrieve Data.<br><br> <button mat-raised-button (click)="retryFetchData()">Try Again</button></span>
  </div>
  <button mat-raised-button class="create-button" *ngIf="isAuth && !isLoading && hasFetchedInstances && hasFetchedCharacters && hasFetchedPurposes && hasFetchedJobs && !this.routeParams.id" (click)="confirmCreate()" matTooltip="Create a New Party">
    <mat-icon>
      create
    </mat-icon>
    New Party
  </button>
  <button mat-raised-button [ngClass]="{filterOn: isFiltering(), filterOff: !isFiltering()}" *ngIf="!isLoading && hasFetchedInstances && hasFetchedCharacters && hasFetchedPurposes && hasFetchedJobs && !this.routeParams.id" (click)="toggleFilters()" matTooltip="Show/Hide Filters">
    <mat-icon>
      filter_list
    </mat-icon>
    Filters: {{ isFiltering() ? 'ON' : 'OFF' }}
  </button>
</div>
<div *ngIf="displayFilters" class="search-filters">
  <app-partyfilter></app-partyfilter>
</div>
<div class="parties-container" *ngIf="!isLoading">
  <mat-paginator *ngIf="!this.routeParams.id && parties != null && parties.length > 0" [length]="length" [pageSize]="pageSize" [pageSizeOptions]="pageSizeOptions" [pageIndex]="currentPage-1" (page)="onChangePage($event)"></mat-paginator>
  <app-partycard [partyDetails]="party" *ngFor="let party of parties"></app-partycard>
  <ng-container *ngIf="parties != null && parties.length == 0"><span style="margin-top: 20px; margin-bottom: 20px;">No parties found, try easing up on the filters or creating your own party.</span></ng-container>
  <mat-paginator *ngIf="!this.routeParams.id" [length]="length" [pageSize]="pageSize" [pageSizeOptions]="pageSizeOptions" [pageIndex]="currentPage-1" (page)="onChangePage($event)"></mat-paginator>
</div>